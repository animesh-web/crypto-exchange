function getprice(e,t){var n=new XMLHttpRequest;n.open("GET","http://localhost/ExchangeWebsite/backend/tools.php?command=get_crypto_price&main=true&crypto="+e,!0),n.send(),n.onload=function(){if(4===n.readyState){var e=n.responseText;if(e.length>0){var c=JSON.parse(e);c.status&&(t(c),updateprice())}}}}function updateprice(){var e=$("#amount-send").val(),t=$("#currency-send").val().toString().toLowerCase(),n=parseFloat($("#"+t+"-price").val()),c=$("#currency-receive").val().toString().toLowerCase(),s=e*n/parseFloat($("#"+c+"-price").val());$("#amount-receive").val(Math.round(1e5*s)/1e5)}function perv(e){var t=e.target;$(t).hasClass("send")||$(t).hasClass("receive")||$(t).hasClass("top-menu-exchange-box-cryptoselect")||$(t).hasClass("section-top-exchange-row-cryptos")||$(t).hasClass("section-top-exchange-search")||$(t).hasClass("top-menu-exchange-box-cryptoselect")||$(t).hasClass("section-top-exchange-search")||($("#box-receive").css("display","none"),$("#box-send").css("display","none"),$(document).on("click",function(){}))}document.addEventListener("DOMContentLoaded",function(){document.getElementById("amount-send").addEventListener("input",function(e){var t=e.target.value,n=$("#currency-send").val().toString().toLowerCase(),c=parseFloat($("#"+n+"-price").val()),s=$("#currency-receive").val().toString().toLowerCase(),o=t*c/parseFloat($("#"+s+"-price").val());$("#amount-receive").val(Math.round(1e4*o)/1e4)}),$("#toggle-send").on("click",function(){"flex"===$("#box-send").css("display")?$("#box-send").css({display:"none"}):($("#box-send").css({display:"flex"}),$("#box-receive").css({display:"none"}),$(document).on("click",perv))}),$("#toggle-receive").on("click",function(){"flex"===$("#box-receive").css("display")?$("#box-receive").css({display:"none"}):($("#box-receive").css({display:"flex"}),$("#box-send").css({display:"none"}),$(document).on("click",perv))}),$(".section-top-exchange-row-cryptos-list-item.send").on("click",function(){$(".section-top-exchange-row-cryptos-list-item.send").removeClass("active"),$(this).toggleClass("active");var e=$(this)[0].firstElementChild.children[1].innerHTML,t=$(this)[0].lastElementChild.innerHTML;$("#send-currency").text(t),$("#currency-send").val(t),$("#selector-send-currency-name").text(e),setTimeout(function(){$("#box-send").css({display:"none"}),$(document).on("click",function(){})},300)}),$(".section-top-exchange-row-cryptos-list-item.receive").on("click",function(){$(".section-top-exchange-row-cryptos-list-item.receive").removeClass("active"),$(this).toggleClass("active");var e=$(this)[0].firstElementChild.children[1].innerHTML,t=$(this)[0].lastElementChild.innerHTML;$("#receive-currency").text(t),$("#currency-receive").val(t),$("#selector-receive-currency-name").text(e),setTimeout(function(){$("#box-receive").css({display:"none"}),$(document).on("click",function(){})},300)}),$(".section-top-exchange-value-amount").on("keypress",function(e){var t=e.key;if(t.match(/\D/)){if("."!==t)return!1;if($(this).val().includes("."))return!1}}),$(".section-top-exchange-buttonreverse").on("click",function(){var e=$("#amount-send").val(),t=$("#amount-receive").val();$("#amount-receive").val(e),$("#amount-send").val(t);var n=$("#send-currency").text(),c=$("#receive-currency").text();$("#receive-currency").text(n),$("#send-currency").text(c),$("#currency-send").val(c),$("#currency-receive").val(n);var s=$("#selector-send-currency-name").text(),o=$("#selector-receive-currency-name").text();$("#selector-receive-currency-name").text(s),$("#selector-send-currency-name").text(o);var r=$(".section-top-exchange-row-cryptos-list-item.send.active")[0].id,i=$(".section-top-exchange-row-cryptos-list-item.receive.active")[0].id,a=i;i=r.replace("send","receive"),r=a.replace("receive","send"),$(".section-top-exchange-row-cryptos-list-item.receive.active").removeClass("active"),$(".section-top-exchange-row-cryptos-list-item.send.active").removeClass("active"),$("#"+i).toggleClass("active"),$("#"+r).toggleClass("active"),updateprice()}),$("#crypto-select-search-send").on("input",function(e){var t=$(this).val();if(t.length<=0)$(".section-top-exchange-row-cryptos-list-item.send").css("display","flex");else{var n=$(".section-top-exchange-row-cryptos-list-item.send");for(let e=0;e<n.length;e++)!1===n[e].firstElementChild.children[1].innerHTML.toLowerCase().includes(t.toLowerCase())?$(n[e]).css("display","none"):$(n[e]).css("display","flex")}}),$("#crypto-select-search-receive").on("input",function(e){var t=$(this).val();if(t.length<=0)$(".section-top-exchange-row-cryptos-list-item.receive").css("display","flex");else{var n=$(".section-top-exchange-row-cryptos-list-item.receive");for(let e=0;e<n.length;e++)!1===n[e].firstElementChild.children[1].innerHTML.toLowerCase().includes(t.toLowerCase())?$(n[e]).css("display","none"):$(n[e]).css("display","flex")}}),$(".section-top-exchange-button").on("click",function(){updateprice();var e=$("#currency-send").val(),t=$("#currency-receive").val(),n=$("#amount-send").val(),c=$("#amount-receive").val(),s=new XMLHttpRequest;s.onerror=function(){alert("unexpected error, try again")},s.open("POST","http://localhost/ExchangeWebsite/backend/auth.php?ref=mainexchange",!0),s.setRequestHeader("Content-Type","application-json"),s.send('{"command":"generate_access_token"}'),s.onload=function(){if(4===s.readyState){var o=s.responseText;if(o.length>3){var r=JSON.parse(o);if(r.status){var i=r.token;(s=new XMLHttpRequest).open("GET","http://localhost/ExchangeWebsite/backend/tools.php?command=create_bill&from="+e+"&to="+t+"&fromamount="+n+"&toamount="+c,!0),s.onload=function(){4===s.readyState&&(o=s.responseText).length>5&&((r=JSON.parse(o)).status?window.location="http://localhost/ExchangeWebsite/backend/main-exchange.php?id="+r.id+"&access_token="+i:window.location="http://localhost/ExchangeWebsite/backend/login.php")},s.send()}else alert(r.error)}}}}),setInterval(function(){$(".main-prices-item").each(function(){var e=$(this)[0].id.toString().split("-")[0],t=e;getprice((e+="USDT").toUpperCase(),function(e){$("#"+t+"-price").val(e.price)})})},5e3)});