function updateprice(){var e=$("#amount-send").val(),t=$("#currency-send").val().toString().toLowerCase(),n=parseFloat($("#"+t+"-price").text()),c=$("#currency-receive").val().toString().toLowerCase(),s=e*n/parseFloat($("#"+c+"-price").text());$("#amount-receive").val(Math.round(1e5*s)/1e5)}function checkauth(){var e=new XMLHttpRequest;e.open("GET","http://localhost/ExchangeWebsite/backend/auth.php?command=validate-auth",!0),e.send(),e.onload=function(){if(4===e.readyState){var t=e.responseText;if(t.length>1)JSON.parse(t).status||(window.location="login.php")}}}function getprice(e,t){var n=new XMLHttpRequest;n.open("GET","http://localhost/ExchangeWebsite/backend/tools.php?command=get_crypto_price&crypto="+e,!0),n.send(),n.onload=function(){if(4===n.readyState){var e=n.responseText;if(e.length>0){var c=JSON.parse(e);c.status&&(t(c),updateprice())}}}}function perv(e){var t=e.target;$(t).hasClass("send")||$(t).hasClass("receive")||$(t).hasClass("top-menu-exchange-box-cryptoselect")||$(t).hasClass("section-top-exchange-row-cryptos")||$(t).hasClass("section-top-exchange-search")||$(t).hasClass("top-menu-exchange-box-cryptoselect")||$(t).hasClass("section-top-exchange-search")||($("#box-receive").css("display","none"),$("#box-send").css("display","none"),$(document).on("click",function(){}))}document.addEventListener("DOMContentLoaded",function(){document.getElementById("amount-send").addEventListener("input",function(e){var t=e.target.value,n=$("#currency-send").val().toString().toLowerCase(),c=parseFloat($("#"+n+"-price").text()),s=$("#currency-receive").val().toString().toLowerCase(),r=t*c/parseFloat($("#"+s+"-price").text());$("#amount-receive").val(Math.round(1e5*r)/1e5)}),setInterval(function(){$(".main-prices-item").each(function(){var e=$(this)[0].id.toString().split("-")[2],t=e;getprice((e+="USDT").toUpperCase(),function(e){$("#"+t+"-price").text(e.price),$("#"+t+"-percent").text(e.percent)})}),checkauth()},5e3),$(".bottom-menu-item").on("click",function(){$(".bottom-menu-item").removeClass("bottom-menu-item-active"),$(this).toggleClass("bottom-menu-item-active")}),$(".svgemption").on("click",function(){$(".svgemption").removeClass("svg-emotion-active"),$(this).toggleClass("svg-emotion-active")}),$(".section-top-exchange-row-cryptos-list-item.send").on("click",function(e){e.stopPropagation(),$(".section-top-exchange-row-cryptos-list-item.send").removeClass("active"),$(this).toggleClass("active");var t=$(this)[0].lastElementChild.innerHTML,n=$(this)[0].firstElementChild.children[0].src,c=$(this)[0].firstElementChild.children[1].innerHTML;$("#currency-send").val(t),$("#send-currency").text(t),$("#selector-send-currency-name").text(c),$("#selector-send-currency-image").attr("src",n),setTimeout(function(){$("#box-send").css({display:"none"}),$(document).on("click",function(){})},300)}),$(".section-top-exchange-row-cryptos-list-item.receive").on("click",function(e){e.stopPropagation(),$(".section-top-exchange-row-cryptos-list-item.receive").removeClass("active"),$(this).toggleClass("active");var t=$(this)[0].lastElementChild.innerHTML,n=$(this)[0].firstElementChild.children[0].src,c=$(this)[0].firstElementChild.children[1].innerHTML;$("#currency-receive").val(t),$("#receive-currency").text(t),$("#selector-receive-currency-name").text(c),$("#selector-receive-currency-image").attr("src",n),setTimeout(function(){$("#box-receive").css({display:"none"}),$(document).on("click",function(){})},300)}),$(".top-menu-exchange-box-cryptoselect.send").on("click",function(){"none"===$("#box-send").css("display")&&($("#box-send").css("display","flex"),$("#box-receive").css("display","none"),$(document).on("click",perv))}),$(".top-menu-exchange-box-cryptoselect.receive").on("click",function(){"none"===$("#box-receive").css("display")&&($("#box-receive").css("display","flex"),$("#box-send").css("display","none"),$(document).on("click",perv))}),$(".top-menu-exchange-box-cryptoselect-swap").on("click",function(){var e=$("#amount-send").val(),t=$("#amount-receive").val();$("#amount-receive").val(e),$("#amount-send").val(t);var n=$("#send-currency").text(),c=$("#receive-currency").text();$("#receive-currency").text(n),$("#send-currency").text(c),$("#currency-send").val(c),$("#currency-receive").val(n);var s=$("#selector-send-currency-name").text(),r=$("#selector-receive-currency-name").text();$("#selector-receive-currency-name").text(s),$("#selector-send-currency-name").text(r);var o=$(".section-top-exchange-row-cryptos-list-item.send.active")[0].id,i=$(".section-top-exchange-row-cryptos-list-item.receive.active")[0].id,a=i;i=o.replace("send","receive"),o=a.replace("receive","send"),$(".section-top-exchange-row-cryptos-list-item.receive.active").removeClass("active"),$(".section-top-exchange-row-cryptos-list-item.send.active").removeClass("active"),$("#"+i).toggleClass("active"),$("#"+o).toggleClass("active");var l=$("#selector-send-currency-image").attr("src"),p=$("#selector-receive-currency-image").attr("src");$("#selector-receive-currency-image").attr("src",l),$("#selector-send-currency-image").attr("src",p),updateprice()}),$("#main-ex-one-submit").on("click",function(){updateprice();var e=$("#currency-send").val(),t=$("#currency-receive").val(),n=$("#amount-send").val(),c=$("#amount-receive").val(),s=new XMLHttpRequest;s.onerror=function(){alert("unexpected error, try again")},s.open("POST","http://localhost/ExchangeWebsite/backend/auth.php?ref=mainexchange",!0),s.setRequestHeader("Content-Type","application-json"),s.send('{"command":"generate_access_token"}'),s.onload=function(){if(4===s.readyState){var r=s.responseText;if(r.length>3){var o=JSON.parse(r);if(o.status){var i=o.token;(s=new XMLHttpRequest).open("GET","http://localhost/ExchangeWebsite/backend/tools.php?command=create_bill&from="+e+"&to="+t+"&fromamount="+n+"&toamount="+c,!0),s.onload=function(){4===s.readyState&&(r=s.responseText).length>5&&(o=JSON.parse(r)).status&&(window.location="http://localhost/ExchangeWebsite/backend/main-exchange.php?id="+o.id+"&access_token="+i)},s.send()}else alert(o.error)}}}}),$("#crypto-select-search-send").on("input",function(e){var t=$(this).val();if(t.length<=0)$(".section-top-exchange-row-cryptos-list-item.send").css("display","flex");else{var n=$(".section-top-exchange-row-cryptos-list-item.send");for(let e=0;e<n.length;e++)!1===n[e].firstElementChild.children[1].innerHTML.toLowerCase().includes(t.toLowerCase())?$(n[e]).css("display","none"):$(n[e]).css("display","flex")}}),$("#crypto-select-search-receive").on("input",function(e){var t=$(this).val();if(t.length<=0)$(".section-top-exchange-row-cryptos-list-item.receive").css("display","flex");else{var n=$(".section-top-exchange-row-cryptos-list-item.receive");for(let e=0;e<n.length;e++)!1===n[e].firstElementChild.children[1].innerHTML.toLowerCase().includes(t.toLowerCase())?$(n[e]).css("display","none"):$(n[e]).css("display","flex")}})});